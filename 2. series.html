<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1440, maximum-scale=1.0" />
    <link rel="shortcut icon" type="image/png" href="https://animaproject.s3.amazonaws.com/home/favicon.png" />
    <meta name="og:type" content="website" />
    <meta name="twitter:card" content="photo" />
    <link rel="stylesheet" type="text/css" href="css/series-ministry-leader-1.css" />
    <link rel="stylesheet" type="text/css" href="css/styleguide.css" />
    <link rel="stylesheet" type="text/css" href="css/globals.css" />
    <title>Thread - Series</title>
  </head>
  <body style="margin: 0; background: #ffffff">
    <div class="series-ministry-leader-1 screen">
      <!-- Background -->
      <img class="white-woven-fabric-1" src="img/white-woven-fabric-1.png" alt="white-woven-fabric 1" />

      <!-- Sidebar -->
      <div class="rectangle-8"></div>
      <img class="line-27 line" src="img/line-27.svg" alt="Line 27" />
      <img class="logo-1" src="img/logo-1.png" alt="LOGO 1" />

      <!-- Navigation -->
      <div class="group-99">
        <a href="1. dashboard.html" class="dashboard manrope-bold-pickled-bluewood-22px nav-link" data-icon="dashboard">Dashboard</a>
        <a href="2. series.html" class="group-99-item manrope-extra-bold-pickled-bluewood-22px nav-link" data-icon="series">Series</a>
        <a href="16. members.html" class="group-99-item manrope-bold-pickled-bluewood-22px nav-link" data-icon="members">Members</a>
        <a href="17. notifications.html" class="notifications manrope-bold-pickled-bluewood-22px nav-link" data-icon="notifications">Notifications</a>
        <div class="settings manrope-bold-pickled-bluewood-22px">Settings</div>
        <div class="logout manrope-bold-pickled-bluewood-22px">Logout</div>
      </div>

      <!-- Navigation Icons -->
      <div class="group-100">
        <div class="layer_1 nav-icon" data-icon="dashboard">
          <div class="gnwuq5">
            <div class="group-3">
              <img class="vector" src="img/vector.svg" alt="Vector" />
              <img class="vector-1" src="img/vector-1.svg" alt="Vector" />
            </div>
          </div>
        </div>
        <img class="layer_1-1 nav-icon" src="img/layer-1.svg" alt="Layer_1" data-icon="series" />
        <div class="group-69 nav-icon" data-icon="members">
          <img class="vector-2" src="img/vector-2.svg" alt="Vector" />
          <img class="vector-3" src="img/vector-3.svg" alt="Vector" />
          <img class="vector-4" src="img/vector-4.svg" alt="Vector" />
          <img class="vector-5" src="img/vector-5.svg" alt="Vector" />
        </div>
        <div class="group-31 nav-icon" data-icon="notifications">
          <img class="bell" src="img/bell.svg" alt="Bell" />
          <div class="ellipse-14"></div>
        </div>
        <img class="g-ic55z" src="img/gic55z@2x.png" alt="gIC55z" />
      </div>

      <!-- Top Bar -->
      <div class="rectangle-12"></div>
      <div class="search-for-a-resource manrope-medium-white-22px">Search for a resource...</div>
      <div class="group-33"></div>
      <div class="name manrope-bold-pickled-bluewood-22px">Josie Ziegler</div>
      <img class="profile-2" src="img/profile-2@2x.png" alt="Profile 2" />

      <!-- Main Content Container -->
      <div class="rectangle-11">

        <!-- Quick Filters -->
        <div class="filter-bar">
          <div class="filter-bar-left">
            <button class="filter-btn active" data-filter="all">All</button>
            <button class="filter-btn" data-filter="thread-series">Thread Series</button>
            <button class="filter-btn" data-filter="my-church-series">My Church Series</button>
            <button class="filter-btn" data-filter="thread-library">Thread Library</button>
          </div>
          <div class="filter-bar-right">
            <button class="tag-filter" data-tag="COMPLETE SERIES">COMPLETE SERIES</button>
            <button class="tag-filter" data-tag="THREAD KIDS">THREAD KIDS</button>
            <button class="tag-filter" data-tag="LEADER RESOURCES">LEADER RESOURCES</button>
            <button class="tag-filter" data-tag="APP RESOURCES">APP RESOURCES</button>
          </div>
        </div>

        <!-- Thread Series Resources Section -->
        <div class="series-section" data-category="thread-series">
          <h2 class="section-title manrope-bold-white-18px">Thread Series</h2>
          <div class="series-grid">

            <!-- Card 1: Welcome + Onboarding -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-10-22-at-9-21-40-pm-1.png" alt="Welcome + Onboarding" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Welcome + Onboarding</div>
            </div>

            <!-- Card 2: Episodes 0-4 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-01.png" alt="Episodes 0-4" class="card-image" />
                <button class="star-btn starred">
                  <img src="img/star.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Ep 4. The Story of Our Faith</div>
            </div>

            <!-- Card 3: Episodes 5-11 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-02.png" alt="Episodes 5-11" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 5-11</div>
            </div>

            <!-- Card 4: Episodes 12-19 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-03.png" alt="Episodes 12-19" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 12-19</div>
            </div>

            <!-- Card 5: Episodes 20-26 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-04.png" alt="Episodes 20-26" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 20-26</div>
            </div>

            <!-- Card 6: Episodes 27-30 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-05.png" alt="Episodes 27-30" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 27-30</div>
            </div>

            <!-- Card 7: Episodes 31-35 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-06.png" alt="Episodes 31-35" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 31-35</div>
            </div>

            <!-- Card 8: Episodes 36-41 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-07.png" alt="Episodes 36-41" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 36-41</div>
            </div>

            <!-- Card 9: Episodes 42-47 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/youtube-playlist-thumbnails-1.png" alt="Episodes 42-47" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 42-47</div>
            </div>

            <!-- Card 10: Episodes 49-55 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-06-30-at-2-39-05-pm-1@2x.png" alt="Episodes 49-55" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 49-55</div>
            </div>

            <!-- Card 11: Episodes 56-60 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-10-22-at-6-12-01-pm-1@2x.png" alt="Episodes 56-60" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 56-60</div>
            </div>

            <!-- Card 12: Episodes 61-68 -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-10-22-at-6-24-31-pm-1.png" alt="Episodes 61-68" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Episodes 61-68</div>
            </div>

          </div>
        </div>


        <!-- My Church Series Section -->
        <div class="series-section" data-category="my-church-series">
          <div class="section-header">
            <h2 class="section-title manrope-bold-white-18px">My Church Series</h2>
            <button class="create-your-own-btn">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" class="plus-icon">
                <circle cx="10" cy="10" r="10" fill="white"/>
                <path d="M10 5V15M5 10H15" stroke="#D9A74B" stroke-width="2" stroke-linecap="round"/>
              </svg>
              <span>Create Your Own</span>
            </button>
          </div>
          <div class="series-grid">

            <!-- Card 1: Kingdom Kids -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Kingdom Kids" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-1.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">THREAD KIDS</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Kingdom Kids</div>
            </div>

            <!-- Card 2: Family Devotions -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Family Devotions" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                  <span class="tag">THREAD KIDS</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Family Devotions</div>
            </div>

            <!-- Card 3: Leadership Essentials -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Leadership Essentials" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                  <span class="tag">LEADER RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Leadership Essentials</div>
            </div>

            <!-- Card 4: Advent Journey -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Advent Journey" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Advent Journey</div>
            </div>

          </div>
        </div>


        <!-- Global Library Series Resources Section -->
        <div class="series-section" data-category="thread-library">
          <h2 class="section-title manrope-bold-white-18px">Thread Library</h2>
          <div class="series-grid">

            <!-- Card 1: Encounter -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-05-21-at-2-09-20-pm-1.png" alt="Encounter" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-3.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Encounter</div>
            </div>

            <!-- Card 2: Places of Prayer -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-05-21-at-2-19-50-pm-1.png" alt="Places of Prayer" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-1.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Places of Prayer</div>
            </div>

            <!-- Card 3: Treasuring God -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/screenshot-2025-10-22-at-9-36-29-pm-1@2x.png" alt="Treasuring God" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Treasuring God</div>
            </div>

            <!-- Card 4: Light of the World -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/lightoftheworld-1@2x.png" alt="Light of the World" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">COMPLETE SERIES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Light of the World</div>
            </div>


            <!-- Card 5: Psalms of Comfort -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Psalms of Comfort" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-1.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">THREAD KIDS</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Psalms of Comfort</div>
            </div>

            <!-- Card 6: Wisdom for Life -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Wisdom for Life" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Wisdom for Life</div>
            </div>

            <!-- Card 7: Spiritual Disciplines -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Spiritual Disciplines" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                  <span class="tag">LEADER RESOURCES</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Spiritual Disciplines</div>
            </div>

            <!-- Card 8: Sacred Rhythms -->
            <div class="series-card">
              <div class="card-image-container">
                <img src="img/brandingoverviewartboard-1-8-1@2x.png" alt="Sacred Rhythms" class="card-image" />
                <button class="star-btn">
                  <img src="img/star-6.svg" alt="Star" />
                </button>
                <div class="card-tags">
                  <span class="tag">APP RESOURCES</span>
                  <span class="tag">THREAD KIDS</span>
                </div>
              </div>
              <div class="card-title manrope-bold-pickled-bluewood-16px">Sacred Rhythms</div>
            </div>


          </div>
        </div>


      </div><!-- end rectangle-11 -->

    </div>

    <!-- Choose Week Modal -->
    <div id="chooseWeekModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2 class="modal-title">Choose Week</h2>
        <p class="modal-help-text">Choose the week that all members of your group sees when they first open their Thread app.</p>

        <!-- Episode Selection Cards -->
        <div class="episodes-container" id="episodesContainer"></div>

        <!-- Save Button -->
        <button class="modal-save-btn" id="saveBtn">Save</button>
      </div>
    </div>

    <script src="js/series-data.js"></script>
    <script>
      // Navigation hover effects for icons
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(function(link) {
        const iconType = link.getAttribute('data-icon');
        const correspondingIcon = document.querySelector('.nav-icon[data-icon="' + iconType + '"]');

        if (correspondingIcon) {
          link.addEventListener('mouseenter', function() {
            correspondingIcon.style.opacity = '0.6';
          });

          link.addEventListener('mouseleave', function() {
            correspondingIcon.style.opacity = '1';
          });
        }
      });

      // Filter functionality
      const filterBtns = document.querySelectorAll('.filter-btn');
      const tagFilterBtns = document.querySelectorAll('.tag-filter');
      const sections = document.querySelectorAll('.series-section');
      const allCards = document.querySelectorAll('.series-card');
      let activeTagFilters = new Set();

      // Category filter functionality
      filterBtns.forEach(function(btn) {
        btn.addEventListener('click', function() {
          const filter = this.getAttribute('data-filter');

          // Update active button
          filterBtns.forEach(function(b) {
            b.classList.remove('active');
          });
          this.classList.add('active');

          // Show/hide sections based on filter
          if (filter === 'all') {
            sections.forEach(function(section) {
              section.style.display = 'block';
            });
          } else {
            sections.forEach(function(section) {
              const category = section.getAttribute('data-category');
              if (category === filter) {
                section.style.display = 'block';
              } else {
                section.style.display = 'none';
              }
            });
          }

          // Re-apply tag filters if any are active
          if (activeTagFilters.size > 0) {
            allCards.forEach(function(card) {
              const cardTags = card.querySelectorAll('.tag');
              let hasMatchingTag = false;
              let hasCompleteSeries = false;

              cardTags.forEach(function(cardTag) {
                const tagText = cardTag.textContent;
                if (activeTagFilters.has(tagText)) {
                  hasMatchingTag = true;
                }
                if (tagText === 'COMPLETE SERIES') {
                  hasCompleteSeries = true;
                }
              });

              // Show card if it has a matching tag OR has "COMPLETE SERIES" tag, and is in a visible section
              const cardSection = card.closest('.series-section');
              if ((hasMatchingTag || hasCompleteSeries) && cardSection && cardSection.style.display !== 'none') {
                card.style.display = 'block';
              } else {
                card.style.display = 'none';
              }
            });
          } else {
            // No tag filters active, show all cards in visible sections
            allCards.forEach(function(card) {
              const cardSection = card.closest('.series-section');
              if (cardSection && cardSection.style.display !== 'none') {
                card.style.display = 'block';
              } else {
                card.style.display = 'none';
              }
            });
          }
        });
      });

      // Tag filter functionality
      tagFilterBtns.forEach(function(btn) {
        btn.addEventListener('click', function(event) {
          const tag = this.getAttribute('data-tag');
          const isMultiSelect = event.shiftKey || event.ctrlKey || event.metaKey;

          // If clicking the same tag, deselect it
          if (activeTagFilters.has(tag)) {
            activeTagFilters.delete(tag);
            this.classList.remove('active');
          } else {
            // If not holding modifier keys, clear all other tag filters
            if (!isMultiSelect) {
              activeTagFilters.clear();
              tagFilterBtns.forEach(function(b) {
                b.classList.remove('active');
              });
            }
            // Add the new tag
            activeTagFilters.add(tag);
            this.classList.add('active');
          }

          // Filter cards based on active tags
          if (activeTagFilters.size === 0) {
            // No tag filters active, show all cards and sections
            allCards.forEach(function(card) {
              card.style.display = 'block';
            });
            sections.forEach(function(section) {
              if (section.style.display !== 'none') {
                section.style.display = 'block';
              }
            });
          } else {
            // Show only cards that have at least one of the active tags
            // OR cards with "COMPLETE SERIES" tag (catch-all)
            allCards.forEach(function(card) {
              const cardTags = card.querySelectorAll('.tag');
              let hasMatchingTag = false;
              let hasCompleteSeries = false;

              cardTags.forEach(function(cardTag) {
                const tagText = cardTag.textContent;
                if (activeTagFilters.has(tagText)) {
                  hasMatchingTag = true;
                }
                if (tagText === 'COMPLETE SERIES') {
                  hasCompleteSeries = true;
                }
              });

              // Show if has matching tag OR has "COMPLETE SERIES" tag
              card.style.display = (hasMatchingTag || hasCompleteSeries) ? 'block' : 'none';
            });

            // Hide sections that have no visible cards
            sections.forEach(function(section) {
              if (section.style.display !== 'none') {
                const sectionCards = section.querySelectorAll('.series-card');
                let hasVisibleCard = false;

                sectionCards.forEach(function(card) {
                  if (card.style.display !== 'none') {
                    hasVisibleCard = true;
                  }
                });

                section.style.display = hasVisibleCard ? 'block' : 'none';
              }
            });
          }
        });
      });

      // Hide/Show filter bar on scroll
      const rectangle11 = document.querySelector('.rectangle-11');
      const filterBar = document.querySelector('.filter-bar');
      let lastScrollTop = 0;

      rectangle11.addEventListener('scroll', function() {
        const scrollTop = this.scrollTop;

        if (scrollTop > lastScrollTop && scrollTop > 50) {
          // Scrolling down
          filterBar.classList.add('hidden');
        } else {
          // Scrolling up
          filterBar.classList.remove('hidden');
        }

        lastScrollTop = scrollTop;
      });

      // Star button toggle functionality
      const starBtns = document.querySelectorAll('.star-btn');
      starBtns.forEach(function(btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation(); // Prevent card click event

          // Get the card this star button belongs to
          const card = this.closest('.series-card');
          const section = card.closest('.series-section');
          const isThreadLibrary = section && section.getAttribute('data-category') === 'thread-library';

          // Thread Library cards shouldn't have star functionality
          if (isThreadLibrary) {
            return;
          }

          const cardTitle = card.querySelector('.card-title').textContent;

          // Open the Choose Week modal
          openModalForCard(card, cardTitle);
        });
      });      // Card title click functionality
      const cardTitles = document.querySelectorAll('.card-title');
      cardTitles.forEach(function(titleElement) {
        titleElement.addEventListener('click', function(e) {
          e.preventDefault();

          // Get the card and title text
          const card = this.closest('.series-card');
          const cardTitle = this.textContent;

          // Check if this is a Thread Library card
          const section = card.closest('.series-section');
          const isThreadLibrary = section && section.getAttribute('data-category') === 'thread-library';

          if (isThreadLibrary) {
            // Import the series to My Church Series
            importSeriesToMyChurch(card, cardTitle);
          } else {
            // Open the Choose Week modal
            openModalForCard(card, cardTitle);
          }
        });
      });

      // Function to import a series from Thread Library to My Church Series
      function importSeriesToMyChurch(sourceCard, seriesTitle) {
        // Get the My Church Series section
        const myChurchSection = document.querySelector('.series-section[data-category="my-church-series"]');
        const myChurchGrid = myChurchSection.querySelector('.series-grid');

        // Clone the card
        const newCard = sourceCard.cloneNode(true);

        // Make sure the star button is visible (remove any inline styles)
        const starBtn = newCard.querySelector('.star-btn');
        if (starBtn) {
          starBtn.style.display = '';
          // Reset to unstarred state
          starBtn.classList.remove('starred');
          const starImg = starBtn.querySelector('img');
          if (starImg) {
            starImg.src = 'img/star-3.svg';
          }
        }

        // Reset the card title to default (remove any "Ep" prefix if present)
        const newCardTitle = newCard.querySelector('.card-title');
        newCardTitle.textContent = seriesTitle;

        // Add the new card to My Church Series grid
        myChurchGrid.appendChild(newCard);

        // Re-attach event listeners to the new card
        const newStarBtn = newCard.querySelector('.star-btn');
        if (newStarBtn) {
          newStarBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            const card = this.closest('.series-card');
            const cardTitle = card.querySelector('.card-title').textContent;
            openModalForCard(card, cardTitle);
          });
        }

        const newTitleElement = newCard.querySelector('.card-title');
        newTitleElement.addEventListener('click', function(e) {
          e.preventDefault();
          const card = this.closest('.series-card');
          const cardTitle = this.textContent;
          const section = card.closest('.series-section');
          const isThreadLibrary = section && section.getAttribute('data-category') === 'thread-library';

          if (isThreadLibrary) {
            importSeriesToMyChurch(card, cardTitle);
          } else {
            openModalForCard(card, cardTitle);
          }
        });

        // Update the allCards reference to include new card
        allCards = document.querySelectorAll('.series-card');

        // Show a brief confirmation (optional)
        console.log('Series imported to My Church Series:', seriesTitle);
      }

      // Choose Week Modal functionality
      const modal = document.getElementById('chooseWeekModal');
      const closeBtn = document.querySelector('.close');
      const episodesContainer = document.getElementById('episodesContainer');
      const saveBtn = document.getElementById('saveBtn');
      let selectedEpisode = null;
      let currentCard = null;
      let currentSeriesKey = null;

      // Mapping of card titles to series keys
      const cardTitleToSeriesKey = {
        'Welcome + Onboarding': 'welcome-onboarding',
        'Episodes 0-4': '0-4',
        'Episodes 5-11': '5-11',
        'Episodes 12-19': '12-19',
        'Episodes 20-26': '20-26',
        'Episodes 27-30': '27-30',
        'Episodes 31-35': '31-35',
        'Episodes 36-41': '36-41',
        'Episodes 42-47': '42-46',
        'Episode 47': '47',
        'Episodes 49-55': '48-55',
        'Episodes 56-60': '56-60',
        'Episodes 61-68': '61-68',
        'Place of Prayer': 'places-prayer',
        'Kingdom Kids': 'kingdom-kids',
        'Family Devotions': 'family-devotions',
        'Leadership Essentials': 'leadership-essentials',
        'Advent Journey': 'advent-journey',
        'Encounter': 'encounter',
        'Places of Prayer': 'places-of-prayer',
        'Treasuring God': 'treasuring-god',
        'Light of the World': 'light-of-the-world',
        'Psalms of Comfort': 'psalms-of-comfort',
        'Wisdom for Life': 'wisdom-for-life',
        'Spiritual Disciplines': 'spiritual-disciplines',
        'Sacred Rhythms': 'sacred-rhythms'
      };

      // Function to extract series key from card title
      function getSeriesKeyFromTitle(title) {
        // First check for exact match
        if (cardTitleToSeriesKey[title]) {
          return cardTitleToSeriesKey[title];
        }

        // Check if title starts with "Ep " (for specific episodes like "Ep 4. The Story of Our Faith")
        if (title.startsWith('Ep ')) {
          const episodeNumberMatch = title.match(/^Ep\s+(\d+)\./);
          if (episodeNumberMatch) {
            const episodeNumber = parseInt(episodeNumberMatch[1]);
            // Determine which series range this episode belongs to
            if (episodeNumber >= 0 && episodeNumber <= 4) return '0-4';
            if (episodeNumber >= 5 && episodeNumber <= 11) return '5-11';
            if (episodeNumber >= 12 && episodeNumber <= 19) return '12-19';
            if (episodeNumber >= 20 && episodeNumber <= 26) return '20-26';
            if (episodeNumber >= 27 && episodeNumber <= 30) return '27-30';
            if (episodeNumber >= 31 && episodeNumber <= 35) return '31-35';
            if (episodeNumber >= 36 && episodeNumber <= 41) return '36-41';
            if (episodeNumber >= 42 && episodeNumber <= 46) return '42-46';
            if (episodeNumber === 47) return '47';
            if (episodeNumber >= 48 && episodeNumber <= 55) return '48-55';
            if (episodeNumber >= 56 && episodeNumber <= 60) return '56-60';
            if (episodeNumber >= 61 && episodeNumber <= 68) return '61-68';
          }
        }

        return '0-4'; // Default fallback
      }

      // Function to populate episodes for selected series
      function populateEpisodes(seriesKey, currentTitle) {
        episodesContainer.innerHTML = '';
        selectedEpisode = null;
        currentSeriesKey = seriesKey;

        const episodes = seriesEpisodes[seriesKey];
        if (!episodes) {
          return;
        }

        // Get current episode from card title (remove "Ep " prefix if present)
        const currentEpisodeText = currentTitle.replace(/^Ep\s+/, '');

        episodes.forEach(function(episode) {
          const card = document.createElement('div');
          card.className = 'episode-card';
          card.textContent = episode;

          // Check if this episode matches the current card title
          if (episode === currentEpisodeText) {
            card.classList.add('selected');
            selectedEpisode = episode;
          }

          card.addEventListener('click', function() {
            // Remove selected class from all cards
            document.querySelectorAll('.episode-card').forEach(function(c) {
              c.classList.remove('selected');
            });
            // Add selected class to clicked card
            this.classList.add('selected');
            selectedEpisode = episode;
          });
          episodesContainer.appendChild(card);
        });
      }

      // Function to open modal for a specific card
      function openModalForCard(card, cardTitle) {
        modal.style.display = 'block';
        currentCard = card;

        // Get the series key for this card
        const seriesKey = getSeriesKeyFromTitle(cardTitle);

        // Populate episodes for this series
        populateEpisodes(seriesKey, cardTitle);
      }

      // Close modal when X is clicked
      closeBtn.addEventListener('click', function() {
        modal.style.display = 'none';
        currentCard = null;
      });

      // Close modal when clicking outside of it
      window.addEventListener('click', function(event) {
        if (event.target === modal) {
          modal.style.display = 'none';
          currentCard = null;
        }
      });

      // Function to measure text width
      function measureTextWidth(text, element) {
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        const computedStyle = window.getComputedStyle(element);
        context.font = computedStyle.font;
        return context.measureText(text).width;
      }

      // Save button handler
      saveBtn.addEventListener('click', function() {
        if (selectedEpisode && currentCard) {
          console.log('Saved episode:', selectedEpisode);

          // FIRST: Reset ALL cards to their default state
          allCards.forEach(function(card) {
            const cardTitleElement = card.querySelector('.card-title');
            const currentTitle = cardTitleElement.textContent;

            // Get the series key for this card to find its default name
            const seriesKey = getSeriesKeyFromTitle(currentTitle);
            const defaultName = episodeNames[seriesKey];

            // Reset title to default
            if (defaultName) {
              cardTitleElement.textContent = defaultName;
            }

            // Un-star the card
            const starBtn = card.querySelector('.star-btn');
            starBtn.classList.remove('starred');

            // Update star icon to unstarred state
            const starImg = starBtn.querySelector('img');
            if (starImg) {
              // Use one of the unstarred star images (we can use star-3.svg as default)
              starImg.src = 'img/star-3.svg';
            }
          });

          // THEN: Update the current card with the selected episode
          const cardTitleElement = currentCard.querySelector('.card-title');
          const newText = 'Ep ' + selectedEpisode;
          cardTitleElement.textContent = newText;

          // Star the current card
          const starBtn = currentCard.querySelector('.star-btn');
          starBtn.classList.add('starred');

          // Update the star icon to starred state
          const starImg = starBtn.querySelector('img');
          if (starImg) {
            starImg.src = 'img/star.svg';
          }

          modal.style.display = 'none';
          currentCard = null;
        } else {
          alert('Please select an episode first');
        }
      });
    </script>
  </body>
</html>
